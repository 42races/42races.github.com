<p>For a long time I was wondering how people have created images using 
pure html and css. Initially I thought they might have done it with 
the help of some image editor in some other complicated way. Then I came 
across ImageMagick library which provides so many image manipulation
methods.</p>

<p>For doing image manipulation in ruby you can use the very famous rmagick
gem. So here is a program below which will accept an image filename as 
input and produces an html file with the complete image constructed using 
html and css style. But I am sure there will be better ways to do that.</p>
<div class="highlight"><pre><span class="c1">#!/usr/bin/env ruby</span>

<span class="nb">require</span> <span class="s1">&#39;RMagick&#39;</span>

<span class="k">class</span> <span class="nc">ImageGenerator</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="nb">exit</span> <span class="k">unless</span> <span class="no">File</span><span class="o">.</span><span class="n">exists?</span> <span class="n">path</span>
    <span class="vi">@title</span>  <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span>
    <span class="vi">@image</span>  <span class="o">=</span> <span class="no">Magick</span><span class="o">::</span><span class="no">Image</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
    <span class="vi">@output</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;index.html&quot;</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">)</span>
    <span class="n">generate</span>
    <span class="vi">@output</span><span class="o">.</span><span class="n">close</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">generate</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;</span><span class="si">#{</span><span class="vi">@title</span><span class="si">}</span><span class="s2">&lt;/title&gt;&lt;style&gt;&lt;/style&gt;</span>
<span class="s2">              &lt;/head&gt;&lt;body&gt;&lt;table cellspacing=0px &gt;&quot;</span>

    <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="vi">@image</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">r</span><span class="o">|</span>
      <span class="n">row</span> <span class="o">=</span> <span class="s2">&quot;&lt;tr&gt;&quot;</span>
      <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="vi">@image</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">c</span><span class="o">|</span> 
        <span class="n">pix</span> <span class="o">=</span> <span class="vi">@image</span><span class="o">.</span><span class="n">get_pixels</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="s2">&quot;&lt;td style=</span><span class="se">\&quot;</span><span class="s2">background-color:</span><span class="si">#{</span><span class="vi">@image</span><span class="o">.</span><span class="n">to_color</span><span class="p">(</span><span class="n">pix</span><span class="o">.</span><span class="n">first</span><span class="p">)</span><span class="si">}</span><span class="s2">;</span><span class="se">\&quot;</span><span class="s2">&gt;&lt;/td&gt;&quot;</span>
      <span class="k">end</span>
      <span class="n">row</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">row</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">end</span>

    <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;&#39;</span>
    <span class="vi">@output</span><span class="o">.</span><span class="n">puts</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="no">ImageGenerator</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="no">ARGV</span><span class="o">.</span><span class="n">first</span><span class="p">)</span> <span class="k">if</span> <span class="no">ARGV</span><span class="o">.</span><span class="n">first</span>
</pre></div>
<p>The idea is to map each pixel in the image to an html table. By styling each cell in the 
table with the corresponding pixel color we can reconstruct the image in html.</p>
